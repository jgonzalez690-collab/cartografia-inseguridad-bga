<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cartograf√≠a Social - Inseguridad en Bucaramanga</title>
    
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />

    <style>
        body { margin: 0; padding: 0; background-color: #2c3e50; }
        #mapa-cartografia { width: 100vw; height: 100vh; background-color: #e5e5e5; }
        
        /* Estilos para los popups */
        .popup-content { text-align: center; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
        .popup-content h3 { margin: 0 0 8px 0; color: #2c3e50; font-size: 1.2em; }
        .popup-content p { margin: 0 0 12px 0; font-size: 0.95em; color: #333; }
        .popup-content video, .popup-content img { width: 100%; max-width: 280px; border-radius: 6px; box-shadow: 0 2px 5px rgba(0,0,0,0.2); margin-top: 5px; }
        
        /* Estilo para que los iconos resalten sobre el mapa */
        .custom-icon i {
            filter: drop-shadow(2px 4px 4px rgba(0,0,0,0.6));
            transition: transform 0.2s;
        }
        .custom-icon i:hover {
            transform: scale(1.2);
        }
    </style>
</head>
<body>

    <div id="mapa-cartografia"></div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://unpkg.com/leaflet.heat/dist/leaflet-heat.js"></script>

    <script>
        // 1. Inicializar mapa (Plano Cartesiano)
        const map = L.map('mapa-cartografia', {
            crs: L.CRS.Simple,
            minZoom: -1,
            maxZoom: 2
        });

        // 2. Cargar tu imagen base
        const imageUrl = 'https://docs.google.com/drawings/d/e/2PACX-1vR8LUlL0Tbj7tHLWt05i7H4BU9LaDa575_ekXCP8ctxWmclerIwk-MibbQ-unWfcFHA3QSN7or-_SJg/pub?w=1440&h=1080';
        const bounds = [[0, 0], [1080, 1440]];
        L.imageOverlay(imageUrl, bounds).addTo(map);
        map.fitBounds(bounds);

        // --- DEFINICI√ìN DE ICONOS PERSONALIZADOS ---
        const iconEscudo = L.divIcon({ html: '<i class="fa-solid fa-shield-halved" style="color: #27ae60; font-size: 28px;"></i>', className: 'custom-icon', iconSize: [28, 28], iconAnchor: [14, 14] });
        const iconAdvertencia = L.divIcon({ html: '<i class="fa-solid fa-triangle-exclamation" style="color: #c0392b; font-size: 28px;"></i>', className: 'custom-icon', iconSize: [28, 28], iconAnchor: [14, 14] });
        const iconCamaraVideo = L.divIcon({ html: '<i class="fa-solid fa-video" style="color: #2980b9; font-size: 26px;"></i>', className: 'custom-icon', iconSize: [26, 26], iconAnchor: [13, 13] });
        // NUEVO ICONO: C√°mara de Fotos para las im√°genes
        const iconFoto = L.divIcon({ html: '<i class="fa-solid fa-camera-retro" style="color: #8e44ad; font-size: 26px;"></i>', className: 'custom-icon', iconSize: [26, 26], iconAnchor: [13, 13] });

        // --- MARCADORES ORIGINALES (Videos y Puntos de Inter√©s) ---
        const markerCentro = L.marker([780, 720], {icon: iconEscudo}).bindPopup('<div class="popup-content"><h3 style="color:#27ae60;">Zona Institucional</h3><p>Alcald√≠a y Gobernaci√≥n.</p></div>');
        const markerConcordia = L.marker([550, 600], {icon: iconEscudo}).bindPopup('<div class="popup-content"><h3 style="color:#27ae60;">Parque La Concordia</h3><video controls preload="metadata"><source src="video-concordia.mp4" type="video/mp4"></video></div>', { minWidth: 300 });
        const markerSanPio = L.marker([500, 950], {icon: iconAdvertencia}).bindPopup('<div class="popup-content"><h3 style="color:#c0392b;">Atenci√≥n: Parque San P√≠o</h3><video controls preload="metadata"><source src="video-sanpio.mp4" type="video/mp4"></video></div>', { minWidth: 300 });
        const markerCentroPeligro = L.marker([820, 680], {icon: iconAdvertencia}).bindPopup('<div class="popup-content"><h3 style="color:#c0392b;">Zona de Riesgo (Centro)</h3></div>');
        const markerCamara1 = L.marker([650, 800], {icon: iconCamaraVideo}).bindPopup('<b>C√°mara de Seguridad Operativa</b>');
        const markerCamara2 = L.marker([450, 1050], {icon: iconCamaraVideo}).bindPopup('<b>C√°mara de Seguridad</b>');

        // --- NUEVOS MARCADORES: EVIDENCIAS FOTOGR√ÅFICAS ---
        // (Las coordenadas est√°n esparcidas para que no se amontonen, aj√∫stalas seg√∫n corresponda a cada foto)

        const foto1 = L.marker([790, 740], {icon: iconFoto}).bindPopup(`
            <div class="popup-content">
                <h3 style="color:#8e44ad;">Ilustraci√≥n 3 Ingreso a Bucaramanga de Sur a norte</h3><p>Autopista en sentido sur a norte para el ingreso a Bucaramanga esta es la v√≠a que comunica Bogot√° con Bucaramanga, la distancia por tierra es aproximadamente de 10 horas</p></div>'
                <img src="https://docs.google.com/drawings/d/e/2PACX-1vSwqadudQJlfgmKZVV-1WJ1Gqn6xwcfGsfSuZP7mpepn0KX3x-CyCEMYtGDejrEImOnttexjnOcV2kF/pub?w=960&h=720" alt="Evidencia 1">
            </div>
        `, { minWidth: 300 });

        const foto2 = L.marker([760, 710], {icon: iconFoto}).bindPopup(`
            <div class="popup-content">
                <h3 style="color:#8e44ad;">Evidencia Fotogr√°fica 2</h3>
                <img src="https://docs.google.com/drawings/d/e/2PACX-1vRcR3LxrYehB6d8gKSir49mFuS1Eg82tUZKKjGMZurJFuGKtTk9jHjhM2zkdiet5gBLjbXofR5ljh6m/pub?w=960&h=720" alt="Evidencia 2">
            </div>
        `, { minWidth: 300 });

        const foto3 = L.marker([570, 620], {icon: iconFoto}).bindPopup(`
            <div class="popup-content">
                <h3 style="color:#8e44ad;">Evidencia Fotogr√°fica 3</h3>
                <img src="https://docs.google.com/drawings/d/e/2PACX-1vQVwhBsmTMBHAJ49awsUzsMfKRihEQd51P9yjs9FfP9LevOxhRRPqYUylBjoZq7Bniavn0_geTJ3I6N/pub?w=960&h=720" alt="Evidencia 3">
            </div>
        `, { minWidth: 300 });

        const foto4 = L.marker([540, 580], {icon: iconFoto}).bindPopup(`
            <div class="popup-content">
                <h3 style="color:#8e44ad;">Evidencia Fotogr√°fica 4</h3>
                <img src="https://docs.google.com/drawings/d/e/2PACX-1vSsmaUIznLsRPaN42ZrB9xVEk4LFqSHkon_UXQu6AL8wsNBnx9GG7TRlovKd32bTqSuE1fR0uZJA3do/pub?w=960&h=720" alt="Evidencia 4">
            </div>
        `, { minWidth: 300 });

        const foto5 = L.marker([490, 930], {icon: iconFoto}).bindPopup(`
            <div class="popup-content">
                <h3 style="color:#8e44ad;">Evidencia Fotogr√°fica 5</h3>
                <img src="https://docs.google.com/drawings/d/e/2PACX-1vSxCmQ9OFKTcwCtqtUAc12V9yXtRMQOOQTTQ_XUu_BsgtN9pNb815-Ib_P9frSfIyYrQwyHqGHTTR3r/pub?w=960&h=720" alt="Evidencia 5">
            </div>
        `, { minWidth: 300 });

        const foto6 = L.marker([520, 970], {icon: iconFoto}).bindPopup(`
            <div class="popup-content">
                <h3 style="color:#8e44ad;">Evidencia Fotogr√°fica 6</h3>
                <img src="https://docs.google.com/drawings/d/e/2PACX-1vSrEd_YlRY1mgRlqNYJ3CAACX5cVWZsdbzTh2FIloMKXQvDxv2LPIrW64OAhkFE21AtqGhJ7q3-4hwa/pub?w=960&h=720" alt="Evidencia 6">
            </div>
        `, { minWidth: 300 });

        const foto7 = L.marker([460, 950], {icon: iconFoto}).bindPopup(`
            <div class="popup-content">
                <h3 style="color:#8e44ad;">Evidencia Fotogr√°fica 7</h3>
                <img src="https://docs.google.com/drawings/d/e/2PACX-1vTvZP0G3jA5kNPBClkYqmnY9prC61JAkm_HwqIJ8AoB3VRovXeXZX5LdnJ0N_l99Etxf9oLGEjknKBN/pub?w=851&h=523" alt="Evidencia 7">
            </div>
        `, { minWidth: 300 });

        const foto8 = L.marker([420, 1000], {icon: iconFoto}).bindPopup(`
            <div class="popup-content">
                <h3 style="color:#8e44ad;">Evidencia Fotogr√°fica 8</h3>
                <img src="https://docs.google.com/drawings/d/e/2PACX-1vT_SqKb9ObBOc85uRlW6HfLc8pzom3ErDCTmL_FH7TCoTv1St4ptG8uRmd3h3aQRK1ENDkqK0p8z-Rs/pub?w=960&h=720" alt="Evidencia 8">
            </div>
        `, { minWidth: 300 });

        const foto9 = L.marker([380, 500], {icon: iconFoto}).bindPopup(`
            <div class="popup-content">
                <h3 style="color:#8e44ad;">Evidencia Fotogr√°fica 9</h3>
                <img src="https://docs.google.com/drawings/d/e/2PACX-1vSMoF5XUwWvmam12iFcOxKFoMlcTMPs0MGLTWGANDkBikIZOg3UiLHlobTw2de_c7EOUjU4A38tP-yy/pub?w=960&h=720" alt="Evidencia 9">
            </div>
        `, { minWidth: 300 });


        // --- MAPA DE CALOR (HEATMAP) ---
        const heatData = [
            [500, 950, 0.9], [490, 960, 0.8], [510, 940, 0.7], [505, 955, 0.6], 
            [480, 970, 0.5], [470, 980, 0.4], 
            [820, 680, 0.8], [810, 670, 0.7], [830, 690, 0.6], [815, 685, 0.9], 
            [560, 610, 0.4], [540, 590, 0.3] 
        ];
        const heatLayer = L.heatLayer(heatData, { radius: 45, blur: 30, maxZoom: 2, gradient: { 0.4: 'yellow', 0.6: 'orange', 0.8: 'red', 1.0: 'darkred' } });


        // --- AGRUPAR CAPAS Y A√ëADIR CONTROL ---
        const grupoEscudos = L.layerGroup([markerCentro, markerConcordia]);
        const grupoAdvertencias = L.layerGroup([markerSanPio, markerCentroPeligro]);
        const grupoCamaras = L.layerGroup([markerCamara1, markerCamara2]);
        const grupoFotos = L.layerGroup([foto1, foto2, foto3, foto4, foto5, foto6, foto7, foto8, foto9]); // Nuevo grupo

        // A√±adir al mapa por defecto
        grupoEscudos.addTo(map);
        grupoAdvertencias.addTo(map);
        grupoCamaras.addTo(map);
        grupoFotos.addTo(map);
        heatLayer.addTo(map);

        // Crear el men√∫ de control (arriba a la derecha)
        const capasSuperpuestas = {
            "üõ°Ô∏è Factores Protectores (Polic√≠a)": grupoEscudos,
            "‚ö†Ô∏è Puntos Cr√≠ticos (Advertencia)": grupoAdvertencias,
            "üìπ C√°maras de Video": grupoCamaras,
            "üì∏ Evidencias Fotogr√°ficas": grupoFotos,
            "üî• Mapa de Calor (Riesgo)": heatLayer
        };

        L.control.layers(null, capasSuperpuestas, { collapsed: false }).addTo(map);

    </script>
</body>
</html>
